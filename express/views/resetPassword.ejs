<%- include('includes/head', { title: 'Reset Password' }) %>
<main class="grid place-items-center min-h-screen py-10">
	<section
		class="grid gap-10 max-w-xl w-full bg-base-200 border border-base-300 rounded-box p-10"
	>
		<form
			action="/auth/reset-password/<%= token %>"
			method="POST"
			class="grid gap-8"
		>
			<h1 class="text-4xl">Reset Password</h1>

			<fieldset class="fieldset">
				<legend class="fieldset-legend">Password</legend>
				<label class="input validator w-full">
					<%- include('icons/password') %>
					<input
						required
						type="password"
						name="password"
						placeholder="Password"
						minlength="8"
						pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*]).{8,}"
					/>
				</label>
				<div class="validator-hint hidden">
					<p>Must be more than 8 characters, including</p>
					<p>At least one number</p>
					<p>At least one lowercase letter</p>
					<p>At least one uppercase letter</p>
					<p>At least one special character</p>
				</div>
				<% if (typeof id !== 'undefined' && id === 'password') { %>
				<p class="fieldset-label text-error"><%= message %></p>
				<% } %>
			</fieldset>

			<fieldset class="fieldset">
				<legend class="fieldset-legend">Confirm Password</legend>
				<label class="input validator w-full">
					<%- include('icons/password') %>
					<input
						required
						type="password"
						name="confirmPassword"
						placeholder="Confirm Password"
					/>
				</label>
			</fieldset>

			<% if (typeof id !== 'undefined' && id === 'global') { %>
			<p class="text-error text-xs"><%= message %></p>
			<% } %>

			<div class="w-full grid justify-items-end">
				<button type="submit" class="btn btn-primary">Reset Password</button>
			</div>
		</form>
	</section>
</main>
<%- include('includes/foot') %>

<script type="module">
	const form = document.querySelector("form");
	form.addEventListener("submit", (e) => {
		e.preventDefault();
		const password = document.querySelector("input[name='password']").value;
		const confirmPassword = document.querySelector(
			"input[name='confirmPassword']"
		).value;
		if (password !== confirmPassword) {
			e.preventDefault();
			alert("Passwords do not match");
		} else {
			form.submit();
		}
	});
</script>
